<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title> - 声zzz</title>
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/zenburn.css" rel="stylesheet">
  </head>
  <body>
    <div id="panel">
      <ul class="links">
        <li><a href="/">首页</a></li>
        <li><a href="https://github.com/reusee" target="_blank">Github</a></li>
        <li><a href="https://twitter.com/reusee" target="_blank">Twitter</a></li>
      </div>
    </div>

    <div id="right">


<div id="article">
  <div class="title">给 interface{} 起别名</div>
  <div class="content"><p>在 go 程序里，interface{} 是常用的类型。即使会加入泛型，它仍然有需要用到的地方，例如需要运行期反射的场景。</p>

<p>最近在新项目里我都会用到下面的别名定义</p>

<pre><code class="language-go">
type (
  any = interface{}
  dyn = interface{}
)
</code></pre>

<p>any 表示任意类型，用于需要做 type assertion 的场景。
例如容器类型，或者枚举类型。用泛型可以替代 any。</p>

<p>dyn 表示动态类型，用于需要做 reflect 的场景。
这些场景是泛型不能替代的，例如动态调用、赋值等。</p>

<p>使用这些别名，一来比较简短，二来语义可以更清晰。</p>

<p>类型别名在另外一些场景，也可以起到简化代码的作用，例如</p>

<pre><code class="language-go">
type M = map[string]any
</code></pre>

<p>M 是 string 到 any 的映射，在写嵌套的结构的字面量时，可以让代码简洁一些</p>

<pre><code class="language-go">
var jsonData = M{
  "foo": M{
    "bar": M{
      "baz": []M{
        {
          "quux": 42,
        },
      },
    },
  },
  "ok": true,
}
</code></pre>

<p>如果不用别名，而是用 map[string]interface{}，就相当冗长了。</p>

<p>虽然类型别名的初衷并不是简化代码，而是方便重构，但既然具备上面所述的几个优点，那就可以用。</p>
</div>
</div>

  </div>

  <script type="text/javascript" src="/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script type="text/javascript" src="/js/all.js"></script>
  </body>
</html>

