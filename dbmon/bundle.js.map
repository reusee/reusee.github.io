{"version":3,"sources":["webpack:///webpack/bootstrap f7c6057149ce6150d74f","webpack:///./examples/dbmon/main.js","webpack:///./tags.js","webpack:///./dom.js","webpack:///./equality.js","webpack:///./object.js","webpack:///./app.js","webpack:///./state.js"],"names":["DBMon","state","databases","map","database","DB","dbname","class","lastSample","countClassName","nbQueries","topFiveQueries","query","elapsedClassName","formatElapsed","app","document","getElementById","ENV","generateData","toArray","load","update","Monitoring","renderRate","ping","setTimeout","timeout","helpers","reduce","tag","args","charAt","toUpperCase","slice","module","exports","none","style","display","clear","t","e","patch","element_serial","Node","id","children","attributes","events","text","innerHTML","element","online_callback","selector","classes","parts","match","i","l","length","part","substring","push","cls","join","properties","key","property","Array","isArray","k","v","test","set_children","child","createTextNode","createElement","setAttribute","className","toElement","appendChild","warning","console","warn","value","undefined","element_set_listener","bind","backgroundColor","color","fontWeight","element_events","next_element_serial","ev_type","fn","serial","__element_serial","event_set","addEventListener","substr","ev","thunk","Thunk","name","func","setArgs","node","arg1","arg2","set_selector","set_properties","last_element","last_node","last_thunk","acc","cur","arg_versions","getNode","parentNode","insertBefore","removeChild","nodeValue","style_type","last_style_type","removeAttribute","common_length","Math","min","child_elements","childNodes","firstChild","versions","arg","hasOwnProperty","subs","__aff_version","version","beforeThunkCallFunc","apply","afterThunkCallFunc","setBeforeThunkCallFunc","setAfterThunkCallFunc","equal","a","b","a_version_info","b_version_info","type_a","type_b","va","vb","keys_a","Object","keys","keys_b","object_add_tag","object_has_tag","obj","defineProperty","__proto__","App","patching","updated","init","HTMLElement","node_func","beforeUpdate","afterUpdate","res","copy_update","freeze_all","pick","versionize","versioned_update","$inc","__is_op","op","inplace_apply","$dec","$merge","spec","o2","$push","elem","$reduce","accumulated","what","$del_at","index","$map","$filter","$any","__predict_any","new_obj","all_frozen","freeze","key_updated","desc","getOwnPropertyDescriptor","getter","get","setter","set","enumerable","writable","ret"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f7c6057149ce6150d74f","import { table, tbody, tr, td, div, span } from '../../tags'\nimport { t } from '../../dom'\nimport { App } from '../../app'\n\nfunction DBMon(state) {\n  return div([\n    table('.table .table-striped .latest-data', [\n      tbody([\n        state.databases.map(function(database) {\n          return t(DB, database);\n        }),\n      ]),\n    ]),\n  ]);\n};\n\nfunction DB(database) {\n  return tr({}, [\n    td('.dbname', database.dbname),\n    td('.query-count', [\n      span({ class: database.lastSample.countClassName }, \n        database.lastSample.nbQueries),\n    ]),\n    database.lastSample.topFiveQueries.map(function(query) {\n      return t('Query', function(query) {\n        return td('.Query .' + query.elapsedClassName, [\n          query.formatElapsed,\n          div('.popover .left', [\n            div('.popover-content', query.query),\n            div('.arrow'),\n          ]),\n        ]);\n      }, query);\n    }),\n  ]);\n}\n\nlet app = new App(\n  document.getElementById('app'),\n  DBMon,\n  {\n    databases: ENV.generateData().toArray(),\n  },\n);\n\nfunction load() {\n  app.update('databases', ENV.generateData().toArray());\n  Monitoring.renderRate.ping();\n  setTimeout(load, ENV.timeout);\n};\n\nload();\n\n\n\n\n// WEBPACK FOOTER //\n// ./examples/dbmon/main.js","import {e} from './dom'\n\nlet helpers = [\n  'a', 'abbr', 'acronym', 'address', 'applet', 'area', 'article', 'aside', 'audio',\n  'b', 'base', 'basefont', 'bdi', 'bdo', 'bgsound', 'big', 'blink', 'blockquote', 'body', 'br', 'button',\n  'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'command', 'content',\n  'data', 'datalist', 'dd', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt',\n  'element', 'em', 'embed',\n  'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'frame', 'frameset',\n  'head', 'header', 'hgroup', 'hr', 'html',\n  'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'h7',\n  'i', 'iframe', 'image', 'img', 'input', 'ins', 'isindex',\n  'kbd', 'keygen',\n  'label', 'legend', 'li', 'link', 'listing',\n  'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meta', 'meter', 'multicol',\n  'nav', 'nobr', 'noembed', 'noframes', 'noscript',\n  'object', 'ol', 'optgroup', 'option', 'output',\n  'p', 'param', 'picture', 'plaintext', 'pre', 'progress',\n  'q',\n  'rp', 'rt', 'rtc', 'ruby',\n  's', 'samp', 'script', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup',\n  'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'title', 'tr', 'track', 'tt',\n  'u', 'ul',\n  'var', 'video',\n  'wbr',\n  'xmp',\n].reduce((helpers, tag) => {\n  helpers[tag] = function(...args) {\n    return e(tag, ...args);\n  };\n  helpers[tag.charAt(0).toUpperCase() + tag.slice(1)] = helpers[tag];\n  helpers[tag.toUpperCase()] = helpers[tag];\n  return helpers;\n}, {});\n\nmodule.exports = {\n  ...helpers,\n\n  none: e('div', {\n    style: {\n      display: 'none',\n    },\n  }),\n\n  clear: e('div', {\n    style: {\n      clear: 'both',\n    },\n  }),\n};\n\n\n\n// WEBPACK FOOTER //\n// ./tags.js","import {equal} from './equality'\n\nlet element_serial = 1;\n\nclass Node {\n  constructor() {\n    this.tag = null;\n    this.id = null;\n    this.style = null;\n    this.class = null;\n    this.children = null;\n    this.attributes = null;\n    this.events = null;\n    this.text = null;\n    this.innerHTML = null;\n    this.element = null;\n\n    this.online_callback = null;\n  }\n\n  set_selector(selector) {\n    let classes = [];\n    let parts = selector.match(/[.#][A-Za-z][A-Za-z0-9_:-]*/g);\n    for (let i = 0, l = parts.length; i < l; i++) {\n      let part = parts[i];\n      if (part.charAt(0) == '#') {\n        this.id = part.substring(1);\n      } else if (part.charAt(0) == '.') {\n        classes.push(part.substring(1));\n      }\n    }\n    let cls = classes.join(' ');\n    if (cls.length > 0) {\n      this.class = cls;\n    }\n  }\n\n  set_properties(properties) {\n    for (let key in properties) {\n      if (key == 'id' || key == 'innerHTML') {\n        // id, innerHTML\n        this[key] = properties[key];\n      } else if (key == 'class') {\n        let property = properties.class;\n        if (typeof property == 'string') {\n          this.class = property;\n        } else if (typeof property == 'object') {\n          if (Array.isArray(property)) {\n            this.class = property.join(' ');\n          } else {\n            let classes = [];\n            for (let k in property) {\n              let v = property[k];\n              if (v) {\n                classes.push(k);\n              }\n            }\n            this.class = classes.join(' ');\n          }\n        } else {\n          throw['bad class', property];\n        }\n      } else if (key == 'style') {\n        // styles\n        this.style = properties.style;\n      } else if (/^on/.test(key) && typeof properties[key] === 'function') {\n        if (key == 'online') {\n          this.online_callback = properties[key];\n        } else {\n          // events\n          this.events = this.events || {};\n          this.events[key] = properties[key];\n        }\n      } else {\n        if (\n          (this.tag == 'input' && key == 'checked' && !properties[key])\n          || (this.tag == 'input' && key == 'disabled' && !properties[key])\n          || (this.tag == 'button' && key == 'disabled' && !properties[key])\n        ) {\n          continue\n        }\n        // attributes\n        this.attributes = this.attributes || {};\n        this.attributes[key] = properties[key];\n      }\n    }\n  }\n\n  set_children(children) {\n    this.children = this.children || [];\n    if (Array.isArray(children)) {\n      // flatten\n      for (let i = 0, l = children.length; i < l; i++) {\n        this.set_children(children[i]);\n      }\n    } else if (typeof children === 'string' || typeof children === 'number') {\n      let child = new Node();\n      child.text = children;\n      this.children.push(child);\n    } else {\n      this.children.push(children);\n    }\n  }\n\n  toElement() {\n    let element;\n    if (this.text !== null) {\n      element = document.createTextNode(this.text);\n    } else {\n      element = document.createElement(this.tag);\n      element.setAttribute('aff-element-serial', element_serial);\n      element_serial++;\n    }\n    if (this.innerHTML !== null) {\n      element.innerHTML = this.innerHTML;\n    }\n    if (this.id !== null) {\n      element.id = this.id;\n    }\n    if (this.style !== null) {\n      if (typeof this.style == 'object') {\n        for (let key in this.style) {\n          element.style[key] = this.style[key];\n        }\n      } else {\n        element.style = this.style;\n      }\n    }\n    if (this.class !== null) {\n      element.className = this.class;\n    }\n    if (this.children !== null) {\n      for (let i = 0, l = this.children.length; i < l; i++) {\n        if (!this.children[i] || !this.children[i].toElement) {\n          element.appendChild(warning(`RENDER ERROR: cannot render ${this.children[i]}`).toElement());\n          console.warn('cannot render', this.children[i]);\n        } else {\n          element.appendChild(this.children[i].toElement());\n        }\n      }\n    }\n    if (this.attributes !== null) {\n      for (let key in this.attributes) {\n        let value = this.attributes[key];\n        if (value !== undefined && value !== null) {\n          element.setAttribute(key, value);\n        }\n      }\n    }\n    if (this.events !== null) {\n      for (let key in this.events) {\n        // set event callback, bind current Node to callback\n        // constructor must not be arrow function to get proper 'this'\n        element_set_listener(element, key, this.events[key].bind(this));\n      }\n    }\n    this.element = element;\n    if (this.online_callback) {\n      this.online_callback(element);\n    }\n    return element;\n  }\n\n}\n\nlet warning = (text) => e('div', {\n  style: {\n    backgroundColor: 'yellow',\n    color: 'red',\n    fontWeight: 'bold',\n  },\n}, text);\n\nlet element_events = {};\nlet element_set_listener = (() => {\n  let next_element_serial = 1;\n  return function(element, ev_type, fn) {\n    let serial = element.__element_serial;\n    if (!serial) {\n      serial = next_element_serial;\n      next_element_serial++;\n      element.__element_serial = serial;\n    }\n    let event_set = element_events[serial];\n    if (!event_set) {\n      event_set = {};\n      element_events[serial] = event_set;\n    }\n    if (!(ev_type in event_set)) {\n      element.addEventListener(ev_type.substr(2), function(ev) {\n        return element_events[serial][ev_type](ev);\n      });\n    }\n    event_set[ev_type] = fn;\n  }\n})();\n\n// thunk helper\nexport function t(...args) {\n  if (args.length === 0) {\n    throw['no arguments to t()'];\n  }\n\n  let thunk = new Thunk();\n\n  switch (typeof args[0]) {\n  case 'string': // named thunk\n    thunk.name = args[0];\n    thunk.func = args[1];\n    thunk.setArgs(args.slice(2));\n    break\n\n  case 'function':\n    thunk.func = args[0];\n    thunk.setArgs(args.slice(1));\n    thunk.name = thunk.func.name;\n    break\n  }\n\n  return thunk\n}\n\n// element helper\nexport function e(...args) {\n  if (args.length === 0) {\n    throw['no arguments to e()'];\n  }\n\n  // Thunk\n  if (typeof args[0] === 'function') {\n    let thunk = new Thunk();\n    thunk.func = args[0];\n    thunk.setArgs(args.slice(1));\n    // set thunk name from function, may be undefined\n    thunk.name = thunk.func.name; \n    return thunk;\n  }\n\n  let node = new Node();\n\n  let arg1, arg2;\n\n  switch (args.length) {\n  case 1:\n    // tag only, eg. e('hr')\n    node.tag = args[0];\n\n    break\n\n  case 2:\n    // two args, first the tag, second a selector or children or properties\n    // eg. e('div', '#main .block')\n    // or e('div', 'Hello, world')\n    // or e('div', [ e('p', 'Hello, world') ])\n    // or e('div', { id: 'main' })\n    node.tag = args[0];\n    arg1 = args[1];\n\n    switch (typeof arg1) {\n    case 'string':\n      if (arg1[0] == '#' || arg1[0] == '.') { // selector\n        node.set_selector(arg1);\n      } else { // text node\n        node.set_children(arg1);\n      }\n      break\n\n    case 'number':\n      node.set_children(arg1);\n      break\n\n    case 'object':\n      if (Array.isArray(arg1) || (arg1 instanceof Node) || (arg1 instanceof Thunk)) { // children\n        node.set_children(arg1);\n      } else { // properties\n        node.set_properties(arg1);\n      }\n      break\n\n    default:\n      throw['bad argument at index 1 to e()', args];\n      break\n    }\n\n    break\n\n  case 3:\n    // three args, first the tag, second a selector or properties, third children or properties\n    // eg. e('div', '#main', [ e('p', 'Hello') ])\n    // or e('div', { id: 'main' }, [])\n    node.tag = args[0];\n\n    arg1 = args[1];\n    switch (typeof arg1) {\n    case 'string':\n      node.set_selector(arg1);\n      break\n    case 'object':\n      node.set_properties(arg1);\n      break\n    default:\n      throw['bad argument at index 1 to e()', args];\n      break\n    }\n\n    arg2 = args[2];\n    if (typeof arg2 == 'object' && !Array.isArray(arg2) && !(arg2 instanceof Node) && !(arg2 instanceof Thunk)) {\n      node.set_properties(arg2);\n    } else {\n      node.set_children(arg2);\n    }\n\n    break\n\n  case 4:\n    // four arguments. first tag, second selector, third properties, forth children\n    // eg e('div', '#main', { class: 'foo' }, [ e('div') ])\n    node.tag = args[0];\n    node.set_selector(args[1]);\n    node.set_properties(args[2]);\n    node.set_children(args[3]);\n\n    break\n\n  default:\n    throw['bad arguments to e()', args];\n    break\n  }\n\n  return node;\n}\n\n// patch last_element to represent node attributes, with diffing last_node\nexport function patch(last_element, node, last_node) {\n  // thunk\n  let last_thunk;\n  if (last_node && last_node instanceof Thunk) {\n    last_thunk = last_node;\n    last_node = last_thunk.node;\n  }\n  let thunk;\n  if (node instanceof Thunk) {\n    thunk = node;\n    if (\n      last_thunk \n      && thunk.name == last_thunk.name \n      && thunk.args.length === last_thunk.args.length\n      && thunk.args.reduce((acc, cur, i) => {\n        return acc && equal(\n          cur, last_thunk.args[i],\n          thunk.arg_versions[i], last_thunk.arg_versions[i],\n        );\n      }, true)\n    ) {\n      // reuse node\n      thunk.node = last_thunk.node;\n      // reuse element\n      thunk.element = last_thunk.element;\n    }\n    // get node of thunk\n    node = thunk.getNode();\n  }\n\n  // Thunk.getNode may return another Thunk, patch recursively\n  if (node instanceof Thunk || last_node instanceof Thunk) {\n    return patch(last_element, node, last_node);\n  }\n\n  // no need to patch if two Nodes is the same object\n  // if thunk's node is reuse, will return here\n  if (node === last_node) {\n    return [last_element, node];\n  }\n\n  // not patchable, build a new element\n  if (\n    // not diffable\n    (!last_node)\n    // different tag, no way to patch\n    || (node.tag != last_node.tag)\n    // hacks for input / button with checked / disabled changed\n    || (node.tag == 'input'  && node.attributes && last_node.attributes && node.attributes['checked'] != last_node.attributes['checked'])\n    || (node.tag == 'input'  && node.attributes && last_node.attributes && node.attributes['disabled'] != last_node.attributes['disabled'])\n    || (node.tag == 'button' && node.attributes && last_node.attributes && node.attributes['disabled'] != last_node.attributes['disabled'])\n  ) {\n    let element;\n    if (!node || !node.toElement) {\n      element = warning(`RENDER ERROR: cannot render ${node}`).toElement();\n      console.warn('cannot render', node);\n    } else {\n      element = node.toElement();\n    }\n    // insert new then remove old\n    last_element.parentNode.insertBefore(element, last_element);\n    last_element.parentNode.removeChild(last_element);\n\n    return [element, node];\n  }\n\n  // innerHTML\n  if (node.innerHTML != last_node.innerHTML) {\n    last_element.innerHTML = node.innerHTML;\n  }\n\n  // text\n  if (node.text != last_node.text) {\n    last_element.nodeValue = node.text;\n  }\n\n  // id\n  if (node.id != last_node.id) {\n    last_element.id = node.id;\n  }\n\n  // styles\n  let style_type = typeof node.style;\n  let last_style_type = typeof last_node.style;\n  if (style_type != last_style_type || style_type == 'string') {\n    // not diffable\n    if (style_type == 'object') {\n      // remove all existing style\n      last_element.style = null;\n      // reset\n      for (let key in node.style) {\n        last_element.style[key] = node.style[key];\n      }\n    } else {\n      // set string style\n      if (node.style != last_node.style) {\n        last_element.style = node.style;\n      }\n    }\n  } else {\n    if (node.style && last_node.style) {\n      // common styles\n      for (let key in node.style) {\n        if (node.style[key] != last_node.style[key]) {\n          last_element.style[key] = node.style[key];\n        }\n      }\n      // delete styles exist in old Node but not in new\n      for (let key in last_node.style) {\n        if (!(key in node.style)) {\n          last_element.style[key] = null;\n        }\n      }\n    } else if (node.style) {\n      // new Node only\n      for (let key in node.style) {\n        last_element.style[key] = node.style[key];\n      }\n    } else if (last_node.style) {\n      // no style in new Node, delete all\n      for (let key in last_node.style) {\n        last_element.style[key] = null;\n      }\n    }\n  }\n\n  // class\n  if (node.class != last_node.class) {\n    last_element.className = node.class;\n  }\n\n  // attributes\n  if (node.attributes && last_node.attributes) {\n    // update common attributes\n    for (let key in node.attributes) {\n      if (node.attributes[key] != last_node.attributes[key]) {\n        let value = node.attributes[key];\n        if (value !== undefined && value !== null) {\n          last_element.setAttribute(key, value);\n        }\n      }\n    }\n    // delete non-exist attributes\n    for (let key in last_node.attributes) {\n      if (!(key in node.attributes)) {\n        last_element.removeAttribute(key);\n      }\n    }\n  } else if (node.attributes) {\n    // set new attributes only\n    for (let key in node.attributes) {\n      let value = node.attributes[key];\n      if (value !== undefined && value !== null) {\n        last_element.setAttribute(key, value);\n      }\n    }\n  } else if (last_node.attributes) {\n    // no attributes in new Node, delete all\n    for (let key in last_node.attributes) {\n      last_element.removeAttribute(key);\n    }\n  }\n  \n  // events\n  // not implementing global event proxy\n  if (node.events && last_node.events) {\n    for (let key in node.events) {\n      // set events, bind current node to callback function\n      // to enable referencing current node\n      element_set_listener(last_element, key, node.events[key].bind(node));\n    }\n    let serial = last_element.__element_serial;\n    for (let key in element_events[serial]) {\n      if (!(key in node.events)) {\n        element_events[serial][key] = false;\n      }\n    }\n  } else if (node.events) {\n    for (let key in node.events) {\n      // set events, bind current node to callback function\n      element_set_listener(last_element, key, node.events[key].bind(node));\n    }\n  } else if (last_node.events) {\n    let serial = last_element.__element_serial;\n    for (let key in element_events[serial]) {\n      element_events[serial][key] = false;\n    }\n  }\n\n  // children\n  if (node.children && last_node.children) {\n    // patch common amount of children\n    let common_length = Math.min(node.children.length, last_node.children.length);\n    let child_elements = last_element.childNodes;\n    for (let i = 0; i < common_length; i++) {\n      // recursive patch\n      patch(child_elements[i], node.children[i], last_node.children[i]);\n    }\n    // insert new children\n    for (let i = common_length, l = node.children.length; i < l; i++) {\n      if (!node.children[i] || !node.children[i].toElement) {\n        last_element.appendChild(warning(`RENDER ERROR: cannot render ${node.children[i]}`).toElement());\n        console.warn('cannot render', node.children[i]);\n      } else {\n        last_element.appendChild(node.children[i].toElement());\n      }\n    }\n    // delete\n    for (let i = common_length, l = last_node.children.length; i < l; i++) {\n      last_element.removeChild(last_element.childNodes[common_length]);\n    }\n  } else if (node.children) {\n    // insert only\n    for (let i = 0, l = node.children.length; i < l; i++) {\n      if (!node.children[i] || !node.children[i].toElement) {\n        last_element.appendChild(warning(`RENDER ERROR: cannot render ${node.children[i]}`).toElement());\n        console.warn('cannot render', node.children[i]);\n      } else {\n        last_element.appendChild(node.children[i].toElement());\n      }\n    }\n  } else if (last_node.children) {\n    // delete only\n    while (last_element.firstChild) {\n      last_element.removeChild(last_element.firstChild);\n    }\n  }\n\n  // set element\n  node.element = last_element;\n  if (thunk) {\n    thunk.element = last_element;\n  }\n\n  return [last_element, node];\n}\n\nclass Thunk {\n  constructor() {\n    this.func = null;\n    this.args = null;\n    this.arg_versions = null;\n    this.node = null;\n    this.element = null;\n    this.name = null;\n  }\n\n  setArgs(args) {\n    this.args = args;\n    let versions = [];\n    for (let i = 0; i < this.args.length; i++) {\n      let arg = this.args[i];\n      if (typeof arg === 'object') {\n        if (!Array.isArray(arg) && !arg.hasOwnProperty('__aff_version')) { // plain object\n          let subs = {};\n          for (let key in arg) {\n            if (typeof arg[key] === 'object') {\n              subs[key] = arg[key].__aff_version;\n            }\n          }\n          versions.push({\n            version: arg.__aff_version,\n            subs: subs,\n          });\n        } else {\n          versions.push(arg.__aff_version);\n        }\n      } else {\n        versions.push(undefined);\n      }\n    }\n    this.arg_versions = versions;\n  }\n\n  toElement() {\n    if (!this.element) {\n      let node = this.getNode();\n      if (!node || !node.toElement) {\n        this.element = warning(`RENDER ERROR: cannot render ${node}`).toElement();\n        console.warn('cannot render', node);\n      } else {\n        this.element = node.toElement();\n      }\n    }\n    return this.element;\n  }\n\n  getNode() {\n    if (!this.node) {\n      beforeThunkCallFunc(this);\n      this.node = this.func.apply(this, this.args);\n      afterThunkCallFunc(this);\n      if (!this.node) {\n        throw['constructor of ' + (this.name || 'anonymous') + ' returned null value', this];\n      }\n    }\n    return this.node;\n  }\n\n}\n\nlet beforeThunkCallFunc = (thunk) => {};\nlet afterThunkCallFunc = (thunk) => {};\nexport let setBeforeThunkCallFunc = (fn) => {\n  beforeThunkCallFunc = fn;\n}\nexport let setAfterThunkCallFunc = (fn) => {\n  afterThunkCallFunc = fn;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./dom.js","import {object_has_tag} from './object'\n\nexport function equal(a, b, a_version_info, b_version_info) {\n  let type_a = typeof a;\n  let type_b = typeof b;\n  if (type_a !== type_b) {\n    return false;\n  }\n  if (type_a === 'undefined') {\n    return true;\n  } else if (type_a === 'object') {\n    // frozen objects, compare by reference\n    if (object_has_tag(a, 'frozen') && object_has_tag(b, 'frozen')) {\n      return a === b;\n    }\n    // versioned objects\n    if (a.hasOwnProperty('__aff_version') && b.hasOwnProperty('__aff_version') && a === b) {\n      if (!a_version_info || !b_version_info) {\n        return false;\n      }\n      let va = a_version_info;\n      if (typeof va === 'object') {\n        va = va.version;\n      }\n      let vb = b_version_info;\n      if (typeof vb === 'object') {\n        vb = vb.version;\n      }\n      return va === vb;\n    }\n    // deep compare\n    let keys_a = Object.keys(a);\n    let keys_b = Object.keys(b);\n    if (keys_a.length != keys_b.length) {\n      return false;\n    }\n    for (let key in a) {\n      if (!equal(\n          a[key], b[key],\n          a_version_info && a_version_info.subs ? a_version_info.subs[key] : undefined,\n          b_version_info && b_version_info.subs ? b_version_info.subs[key] : undefined,\n        )) {\n        return false;\n      }\n    }\n    return true;\n  } else if (type_a === 'function') {\n    return a.name === b.name;\n  } else {\n    return a === b;\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./equality.js","export function object_add_tag(obj, tag) {\n  Object.defineProperty(obj, '__tag_' + tag, {\n    __proto__: null,\n    value: true,\n  });\n}\n\nexport function object_has_tag(obj, tag) {\n  return obj['__tag_' + tag] === true;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./object.js","import {\n  copy_update, freeze_all,\n  versioned_update, versionize,\n} from './state'\nimport {patch} from './dom'\n\nexport class App {\n  constructor(...args) {\n    this.node = null;\n    this.patching = false;\n    this.updated = false;\n    this.init(...args);\n  }\n\n  init(...args) {\n    for (let i = 0; i < args.length; i++) {\n      let arg = args[i];\n      if (arg instanceof HTMLElement) {\n        this.element = arg;\n      } else if (typeof arg == 'function') {\n        this.node_func = arg;\n      } else {\n        this.state = arg;\n        //freeze_all(this.state);\n        versionize(this.state);\n      }\n    }\n    if (this.element && this.node_func && this.state) {\n      this.update('__initialized', true);\n    }\n  }\n\n  beforeUpdate() {\n  }\n\n  afterUpdate() {\n  }\n\n  update(...args) {\n    this.beforeUpdate(this.state, ...args);\n    //this.state = copy_update(this.state, ...args);\n    this.state = versioned_update(this.state, ...args);\n    this.afterUpdate(this.state, ...args);\n    if (!this.patching) {\n      this.patching = true;\n      this.updated = false;\n      [this.element, this.node] = patch(this.element, this.node_func(this.state, this.update.bind(this)), this.node);\n      while (this.updated) {\n        // if state is updated when patching, patch again\n        this.updated = false;\n        [this.element, this.node] = patch(this.element, this.node_func(this.state, this.update.bind(this)), this.node);\n      }\n      this.patching = false;\n    } else {\n      // state updated when patching\n      this.updated = true;\n    }\n    return this.state;\n  }\n\n  tap(fn) {\n    let res = fn(this.state);\n    if (res) {\n      this.update(...(Array.isArray(res) ? res : [res]));\n    }\n  }\n\n  html() {\n    return this.element.innerHTML;\n  }\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./app.js","import {object_add_tag, object_has_tag} from './object'\n\n// operations \n\nexport let $inc = {\n  __is_op: true,\n  op: 'inc',\n  apply(obj) {\n    return (obj || 0) + 1;\n  },\n  inplace_apply(obj) {\n    return (obj || 0) + 1;\n  },\n};\n\nexport let $dec = {\n  __is_op: true,\n  op: 'dec',\n  apply(obj) {\n    return obj - 1;\n  },\n  inplace_apply(obj) {\n    return obj - 1;\n  }\n};\n\nexport let $merge = (spec) => ({\n  __is_op: true,\n  op: 'merge',\n  args: [spec],\n  apply(obj) {\n    if (Array.isArray(spec)) {\n      return copy_update(obj, ...spec);\n    }\n    for (let key in spec) {\n      let o2 = spec[key];\n      if (typeof o2 == 'object' && !Array.isArray(o2) && !o2.__is_op) {\n        obj = copy_update(obj, key, $merge(o2));\n      } else {\n        obj = copy_update(obj, key, o2);\n      }\n    }\n    return obj;\n  },\n  inplace_apply(obj) {\n    if (Array.isArray(spec)) {\n      return versioned_update(obj, ...spec);\n    }\n    for (let key in spec) {\n      let o2 = spec[key];\n      if (typeof o2 == 'object' && !Array.isArray(o2) && !o2.__is_op) {\n        obj = versioned_update(obj, key, $merge(o2));\n      } else {\n        obj = versioned_update(obj, key, o2);\n      }\n    }\n    return obj;\n  },\n});\n\nexport let $push = (elem) => ({\n  __is_op: true,\n  op: 'push',\n  args: [elem],\n  apply(obj) {\n    let o2 = [];\n    o2.push(...obj);\n    o2.push(elem);\n    return o2;\n  },\n  inplace_apply(obj) {\n    obj.push(elem);\n    return obj;\n  },\n});\n\nexport let $reduce = (fn, accumulated, what = 'reduce') => ({\n  __is_op: true,\n  op: what,\n  args: [fn, accumulated],\n  apply(obj) {\n    for (let key in obj) {\n      accumulated = fn(accumulated, obj[key], key);\n    }\n    return accumulated;\n  },\n  inplace_apply(obj) {\n    for (let key in obj) {\n      accumulated = fn(accumulated, obj[key], key);\n    }\n    return accumulated;\n  },\n});\n\nexport let $del_at = (i) => $reduce((acc, cur, index) => {\n  if (index != i) {\n    acc.push(cur);\n  }\n  return acc;\n}, [], 'del_at');\n\nexport let $map = (fn) => $reduce((acc, cur, index) => {\n  acc.push(fn(cur));\n  return acc;\n}, [], 'map');\n\nexport let $filter = (fn) => ({\n  __is_op: true,\n  op: 'filter',\n  args: [fn],\n  apply(obj) {\n    if (typeof obj == 'object') {\n      if (Array.isArray(obj)) {\n        let o2 = [];\n        for (let i = 0; i < obj.length; i++) {\n          if (fn(obj[i], i)) {\n            o2.push(obj[i]);\n          }\n        }\n        return o2;\n      } else {\n        let o2 = {};\n        for (let k in obj) {\n          if (fn(obj[k], k)) {\n            o2[k] = obj[k];\n          }\n        }\n        return o2;\n      }\n    } else {\n      return fn(obj);\n    }\n  },\n  inplace_apply(obj) {\n    if (typeof obj == 'object') {\n      if (Array.isArray(obj)) {\n        let o2 = [];\n        for (let i = 0; i < obj.length; i++) {\n          if (fn(obj[i], i)) {\n            o2.push(obj[i]);\n          }\n        }\n        return o2;\n      } else {\n        let o2 = {};\n        for (let k in obj) {\n          if (fn(obj[k], k)) {\n            o2[k] = obj[k];\n          }\n        }\n        return o2;\n      }\n    } else {\n      return fn(obj);\n    }\n  },\n});\n\n// predictions\n\nexport let $any = { __predict_any: true };\n\n// path-copying update\n\nexport function copy_update(obj, ...args) {\n  if (args.length == 0) {\n    // no update\n    return obj;\n  } else if (args.length == 1) {\n    // single op\n    if (args[0].__is_op) {\n      return freeze_all(args[0].apply(obj));\n    } else {\n      return freeze_all(args[0]);\n    }\n  } else {\n    if (Array.isArray(obj)) { \n      // copy update array\n      let index = args[0];\n      let new_obj = [];\n      let all_frozen = true;\n      if (index === $any) {\n        // update all indexes\n        for (let i = 0; i < obj.length; i++) {\n          new_obj.push(copy_update(obj[i], ...args.slice(1)));\n          if (typeof new_obj[i] === 'object' && !object_has_tag(new_obj[i], 'frozen')) {\n            all_frozen = false;\n          }\n        }\n      } else {\n        // only one index\n        for (let i = 0; i < obj.length; i++) {\n          if (i == index) {\n            new_obj.push(copy_update(obj[i], ...args.slice(1)));\n          } else {\n            new_obj.push(obj[i]);\n          }\n          if (typeof new_obj[i] === 'object' && !object_has_tag(new_obj[i], 'frozen')) {\n            all_frozen = false;\n          }\n        }\n      }\n      if (all_frozen) {\n        object_add_tag(new_obj, 'frozen');\n        Object.freeze(new_obj);\n      }\n      return new_obj;\n    } else {\n      // copy update object\n      let key = args[0];\n      let new_obj = {};\n      let all_frozen = true;\n      if (key === $any) {\n        // update all keys\n        for (let k in obj) {\n          new_obj[k] = copy_update(obj[k], ...args.slice(1));\n          if (typeof new_obj[k] === 'object' && !object_has_tag(new_obj[k], 'frozen')) {\n            all_frozen = false;\n          }\n        }\n      } else {\n        // update single key\n        let key_updated = false;\n        for (let k in obj) {\n          if (k == key) {\n            new_obj[k] = copy_update(obj[k], ...args.slice(1));\n            key_updated = true;\n          } else {\n            let desc = Object.getOwnPropertyDescriptor(obj, k);\n            let getter = desc.get;\n            let setter = desc.set;\n            if (getter || setter) {\n              Object.defineProperty(new_obj, k, {\n                get: getter,\n                set: setter,\n                enumerable: true,\n              });\n            } else {\n              new_obj[k] = obj[k];\n            }\n          }\n          if (typeof new_obj[k] === 'object' && !object_has_tag(new_obj[k], 'frozen')) {\n            all_frozen = false;\n          }\n        }\n        if (!key_updated) { // insert\n          new_obj[key] = copy_update(undefined, ...args.slice(1));\n          if (typeof new_obj[key] === 'object' && !object_has_tag(new_obj[key], 'frozen')) {\n            all_frozen = false;\n          }\n        }\n      }\n      if (all_frozen) {\n        object_add_tag(new_obj, 'frozen');\n        Object.freeze(new_obj);\n      }\n      return new_obj;\n    }\n  }\n}\n\nexport function freeze_all(obj) {\n  if (typeof obj !== 'object' || object_has_tag(obj, 'frozen')) {\n    return obj\n  }\n  for (let k in obj) {\n    if (typeof obj[k] == 'object') {\n      freeze_all(obj[k]);\n    }\n  }\n  object_add_tag(obj, 'frozen');\n  Object.freeze(obj);\n  return obj;\n}\n\n// utils\n\nexport function pick(obj, ...keys) {\n  if (typeof obj === 'object') {\n    if (Array.isArray(obj)) {\n      let new_obj = [];\n      for (let i = 0; i < keys.length; i++) {\n        let key = keys[i];\n        if (obj[key] !== undefined) {\n          new_obj.push(obj[key]);\n        }\n      }\n      return new_obj;\n    } else {\n      let new_obj = {};\n      for (let i = 0; i < keys.length; i++) {\n        let key = keys[i];\n        if (obj[key] !== undefined) {\n          new_obj[key] = obj[key];\n        }\n      }\n      return new_obj;\n    }\n  } else {\n    throw['not pickable', obj, keys];\n  }\n}\n\n// versioned update\n\nexport function versionize(obj) {\n  if (typeof obj !== 'object') {\n    return\n  }\n  if (obj.hasOwnProperty('__aff_version')) {\n    obj.__aff_version++;\n    return\n  }\n  for (let k in obj) {\n    versionize(obj[k]);\n  }\n  Object.defineProperty(obj, '__aff_version', {\n    __proto__: null,\n    writable: true,\n    value: 1,\n  });\n}\n\nexport function versioned_update(obj, ...args) {\n  if (args.length === 0) {\n    return obj;\n  } else if (args.length === 1) {\n    let ret;\n    if (args[0].__is_op) {\n      ret = args[0].inplace_apply(obj);\n    } else {\n      ret = args[0];\n    }\n    versionize(ret);\n    return ret;\n  } else {\n    if (!obj) {\n      obj = {};\n      versionize(obj);\n    }\n    if (typeof obj === 'object') {\n      let key = args[0];\n      for (let k in obj) {\n        if (k == key || key === $any) {\n          obj[k] = versioned_update(obj[k], ...args.slice(1));\n        }\n      }\n      if (key !== $any && !(key in obj)) {\n        obj[key] = versioned_update(undefined, ...args.slice(1));\n      }\n      obj.__aff_version++;\n      return obj;\n    } else {\n      throw['bad update path', obj, args];\n    }\n  }\n  throw['no here'];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./state.js"],"sourceRoot":""}